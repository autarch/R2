<& /lib/contact-view/summary.mas, contact => $real_contact &>

% if ( $contact->donation_count() ) {
<table class="standard-table">
  <thead>
    <tr>
      <th>Date</th>
      <th>Amount</th>
      <th>Source</th>
      <th>Target</th>
      <th>Payment Type</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
%   while ( my $donation = $donations->next() ) {
    <tr class="<% $donations->index() % 2 ? 'odd' : 'even' %>">
      <td><% $c->user()->format_date( $donation->donation_date() ) %></td>
      <td>$<% $donation->amount() %></td>
      <td><% $donation->source()->name() %></td>
      <td><% $donation->target()->name() %></td>
      <td><% $donation->payment_type()->name() %></td>
      <td><a href="<% $donation->uri( view => 'edit_form' ) %>">Edit</a></td>
      <td><button>Delete</button></td>
    </tr>
%      if ( my $notes = $donation->notes() ) {
    <tr class="<% $donations->index() % 2 ? 'odd' : 'even' %> notes">
      <td colspan="7"><% $donation->notes() %></td>
    </tr>
%      }
%   }
  </tbody>
</table>
% } else {
<p>
This <% lc $contact->contact_type() %> has not made any donations.
</p>
% }

<& /lib/form/donation.mas, contact => $contact &>

<%args>
$contact
$real_contact
</%args>

<%init>
my $donations = $contact->donations();
</%init>

<%method title>
Donations from <% $real_contact->display_name() %>
<%args>
$real_contact
</%args>
</%method>
