<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>

  <title>Rapport | <& SELF:title, %ARGS &></title>

  <link rel="stylesheet"
        href="<% static_uri('/css/r2-combined.css') %>"
        type="text/css" />

  <script src="<% static_uri( '/js/r2-combined.js' ) %>"
          type="text/javascript"></script>

</head>
<body>

<div id="page">
<& header.mas, %ARGS &>

<div class="yui3-g">
  <div class="<% $show_side_nav ? 'yui3-u-17-24' : 'yui3-u-1' %>">

    <div id="content" class="<% $show_side_nav ? q{} : 'no-side-nav' %>">
  <div id="local-nav">
    <ul>
% for my $nav ( $c->local_nav()->items() ) {
      <li class="<% $nav->is_selected() ? 'selected' : '' %>"
          ><a href="<% $nav->uri() %>"
              title="<% $nav->tooltip %>"><% $nav->label() %></a></li>
% }
% unless ( $c->local_nav()->has_items() ) {
      <!-- we need an element here or else the height of the header
           is different for a page with tabs vs one without -->
      <li class="invisible">&nbsp;</li>
% }
    </ul>
  </div>
      <& .messages &>

% $m->call_next();
    </div>
  </div>

% if ( $m->request_comp()->attr('show_side_nav') ) {
<& side-nav.mas, %ARGS &>
% }
	
</div>

<& footer.mas, %ARGS &>
</div>

</body>
</html>

<%attr>
show_side_nav => 1
side_nav => []
</%attr>

<%init>
my $show_side_nav = $m->request_comp()->attr('show_side_nav');
</%Init>

<%def .messages>
<div id="messages">
% for my $msg (@messages) {
  <p><% $msg %></p>
% }
</div>
<%init>
my @messages = $c->session_object()->messages();

return unless @messages;
</%init>
</%def>
